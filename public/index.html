<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trade Panel</title>

<style>
body {
    background: transparent;
    font-family: Arial, sans-serif;
    color: white;
    padding: 20px;
}
.container { max-width: 430px; margin: 0 auto; }
h2 { text-align: center; margin-bottom: 20px; }

.transaction-type { display: flex; justify-content: space-between; gap: 4%; }
.btn { width: 48%; padding: 12px; border-radius: 8px; border: 2px solid; background: transparent; cursor: pointer; }
.buy-btn { border-color: #2ecc71; color: #2ecc71; }
.sell-btn { border-color: #e67e22; color: #e67e22; }

input, select {
    width: 100%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 8px;
    border: 1px solid #ccc;
    background: transparent !important;
    color: white !important;
    caret-color: white;
}

.trade-btn {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 2px solid #3498db;
    background: transparent;
    color: #3498db;
    margin-top: 20px;
    cursor: pointer;
}
</style>
</head>
<body>

<div class="container">

<h2></h2>

<div class="transaction-type">
    <button class="btn buy-btn" onclick="setType('buy')">Buy</button>
    <button class="btn sell-btn" onclick="setType('sell')">Sell</button>
</div>

<label>Select Coin:</label>
<select id="currency"></select>

<label>Amount:</label>
<input type="number" id="amount" placeholder="Enter amount">

<label>Amount Currency:</label>
<select id="amountCurrency"></select>

<div>
    <label><input type="checkbox" id="slCheckbox" onclick="toggleSL()"> Stop-loss / Take-profit</label>
    <div id="slBox" style="display:none;">
        <input type="number" id="takeProfit" placeholder="TP">
        <input type="number" id="stopLoss" placeholder="SL">
    </div>
</div>

<button class="trade-btn" onclick="sendTrade()">Trade</button>

</div>

<script>
// ------------------ CONFIG ------------------
const BOT_TOKEN = "8423870040:AAEyKQukt720qD7qHZ9YrIS9m_x-E65coPU";

// ç¾¤é€šçŸ¥
const GROUP_ID = -1003262870745;

// å¤šç®¡ç†å‘˜(3äºº)
const ADMINS = [
    6062973135,
    7416199637,
    6615925197
];

// é£æ§é™é¢
const RISK_LIMIT = 50000;

// é˜²æ­¢é‡å¤ç‚¹å‡»
let isSending = false;

// ------------------ UI INIT ------------------
const coins = ["BTC","ETH","USDT","USDC","BNB"];
window.onload = () => {
    const cur = document.getElementById("currency");
    const amtCur = document.getElementById("amountCurrency");

    coins.forEach(c => {
        let o1 = document.createElement("option");
        o1.value = c; o1.textContent = c;
        cur.appendChild(o1);

        let o2 = document.createElement("option");
        o2.value = c; o2.textContent = c;
        amtCur.appendChild(o2);
    });

    amtCur.value = "USDT";
}

let tradeType = "buy";
function setType(type){ tradeType = type; }
function toggleSL(){
    document.getElementById("slBox").style.display =
        document.getElementById("slCheckbox").checked ? "block" : "none";
}

// ------------------ SEND TRADE ------------------
async function sendTrade(){
    if(isSending) return alert("è¯·å‹¿é‡å¤æäº¤ï¼");
    isSending = true;

    const coin = document.getElementById("currency").value;
    const amount = Number(document.getElementById("amount").value);
    const amountCurrency = document.getElementById("amountCurrency").value;

    if(!amount){
        isSending = false;
        return alert("è¯·è¾“å…¥é‡‘é¢");
    }

    // é£æ§æ£€æŸ¥
    if(amount > RISK_LIMIT){
        if(!confirm(`âš  é‡‘é¢è¶…è¿‡ ${RISK_LIMIT} USDTï¼Œç¡®å®šç»§ç»­ï¼Ÿ`)){
            isSending = false;
            return;
        }
    }

    const tp = document.getElementById("takeProfit").value || "None";
    const sl = document.getElementById("stopLoss").value || "None";

    // è‡ªåŠ¨è®¢å•ç¼–å·
    const orderId = Math.floor(100000 + Math.random() * 900000);

    const now = new Date().toLocaleString();

    const msg =
`ğŸ“£ *New Trade Request*
ğŸ†” è®¢å•ç¼–å·: *#${orderId}*

Type: *${tradeType.toUpperCase()}*
Coin: *${coin}*
Amount: *${amount} ${amountCurrency}*
TP: *${tp}*
SL: *${sl}*

Time: ${now}
`;

    // ç®¡ç†å‘˜æŒ‰é’®ï¼ˆé”å• / è§£é”ï¼‰
    const replyMarkup = {
        inline_keyboard: [
            [
                { text: "ğŸ”’ é”å•", callback_data: `lock_${orderId}` },
                { text: "ğŸ”“ è§£é”", callback_data: `unlock_${orderId}` }
            ]
        ]
    };

    // å‘åˆ°ç¾¤
    await tgSend(GROUP_ID, msg, replyMarkup);

    // å‘ç»™å¤šç®¡ç†å‘˜
    for(const adminId of ADMINS){
        await tgSend(adminId, msg, replyMarkup);
    }

    alert("è®¢å•å·²å‘é€ï¼");
    isSending = false;
}

// ------------------ TELEGRAM SEND FUNCTION ------------------
async function tgSend(chatId, text, replyMarkup){
    return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            chat_id: chatId,
            text: text,
            parse_mode: "Markdown",
            reply_markup: replyMarkup
        })
    });
}

</script>

</body>
</html>
